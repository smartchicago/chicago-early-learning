{% comment %}
Copyright (c) 2012 Azavea, Inc.
See LICENSE in the project root for copying permission
{% endcomment %}

{% load i18n %}
{% load staticfiles %}
{% load static %}
<!DOCTYPE html> 
<html> 
  <head>
    <title>{% block title %}{% endblock %}</title> 
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes" />

		<!-- Favicons -->
		<link rel="apple-touch-icon-precomposed" sizes="144x144" href='{% static "img/apple-touch-icon-144-precomposed.png" %}'>
		<link rel="apple-touch-icon-precomposed" sizes="114x114" href='{% static "img/apple-touch-icon-114-precomposed.png" %}'>
		<link rel="apple-touch-icon-precomposed" sizes="72x72" href='{% static "img/apple-touch-icon-72-precomposed.png" %}'>
		<link rel="apple-touch-icon-precomposed" href='{% static "img/apple-touch-icon-57-precomposed.png" %}'>
		<link rel="shortcut icon" href='{% static "img/favicon.png" %}'>
		
    <link href='{% static "css/lib/leaflet.css" %}' rel="stylesheet">
    <link href='{% static "css/lib/bootstrap.css" %}' rel="stylesheet">
    <link href='{% static "css/lib/fontello.css" %}' rel="stylesheet">
    <link href='{% static "css/lib/jquery-ui-1.10.3.autocomplete.min.css" %}' rel="stylesheet">
    <link href='{% static "css/application.css" %}' rel="stylesheet">
    <!--[if lt IE 9]>
      <script src='{% static "js/html5shiv.js" %}'></script>
    <![endif]-->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', '{{ ga_key }}']);
        _gaq.push(['_trackPageview', '{{ request.path }}']);
        _gaq.push(function() {
            _gat._createTracker('{{ ga_key }}', 'outlinkTracker');
        });
    </script>
    {% block otherhead %}{% endblock %}
    <link href='{% static "css/lib/responsive.css" %}' rel="stylesheet">

  </head> 
  <body>
    <!-- Navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <!-- Navbar LEFT -->
        <div class="navbar-left">
          <a class="brand" href="{% url portal.views.index %}" data-r1024="<img src='{% static "img/logo.svg" %}' id='logo' alt='CEL'> Chicago Early Learning"><img src='{% static "img/logo.svg" %}' id="logo" alt="CEL"></a>
        {% block searchform %}{% endblock %}
        </div>
        <!-- Navbar RIGHT -->
        <div class="navbar-right">
          <ul class="nav">
            <li><a href="#text-for-info" data-toggle="modal" data-r1024={% trans "Text For Info" %}><img src='{% static "img/icons/text-for-info.svg" %}' alt="Text For Info"></a></li>
            <li><a href="{% url portal.views.about %}" data-r1024={% trans "About" %}><img src='{% static "img/icons/about.svg" %}' alt="About"></a></li>
            <li><a href="{% url portal.views.faq %}" data-r1024={% trans "FAQ" %}><img src='{% static "img/icons/faq.svg" %}'></a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-r767="{% trans 'Language' %} <b class='caret'></b>">EN <b class="caret"></b></a>

              <ul class="dropdown-menu pull-right">
                {% get_static_prefix as STATIC_PREFIX %}
                {% for lang in LANGUAGES %}
                <li><a class="langlink" href="{% url setlang language=lang.0 %}" data-lang="{{ lang.0 }}"><img src='{{ STATIC_PREFIX }}img/{{ lang.0 }}.png' />&nbsp;&nbsp;{% trans lang.1 %}</a></li>
                {% endfor %}
              </ul>
            </li>
          </ul>
        </div>
	{% block navbar %}{% endblock %}
      </div>
    </div>
    {% block content %}{% endblock %}

    <!-- Text-for-Info Modal -->
    <div id="text-for-info" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="textForInfo" aria-hidden="true">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="textForInfo">{% blocktrans %}Want information via text?{% endblocktrans %}</h3>
      </div>
      <div class="modal-body">
        <p>{% blocktrans %}Text your zip code to {% endblocktrans %}<a href="sms:{{ settings.TWILIO_PHONE }}">{{ settings.TWILIO_PHONE }}</a>{% blocktrans %} and we'll do the rest.{% endblocktrans %}</p>
      </div>
    </div>

    <!-- Share Modal -->
    <div id="share-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="share-modal-label" aria-hidden="true">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="share-modal-label">{% blocktrans %}Save and Share Permalink{% endblocktrans %}</h3>
      </div>
      <div class="modal-body">
        <p>{% blocktrans %}Save the following link, or share it with friends, family, or co-workers.{% endblocktrans %}</p>
        
        <input id="social-text" type="text" readonly="true">
        <a target="_blank" id="social-mail" class="medium fc-webicon mail"><i class="icon-mail-alt"></i></a>
        <a target="_blank" id="social-facebook" class="medium fc-webicon facebook"><i class="icon-facebook-1"></i></a>
        <a target="_blank" id="social-gplus" class="medium fc-webicon googleplus"><i class="icon-gplus"></i></a>
        <a target="_blank" id="social-twitter" class="medium fc-webicon twitter"><i class="icon-twitter-1"></i></a>
      </div>
      <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
      </div>
    </div>

    <script type="text/javascript" src="{% url django.views.i18n.javascript_catalog %}"></script>
    <script type="text/javascript">
    (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
    })();
    </script>
    
    <script src='{% static "js/require.js" %}'></script>
    <script src='{% static "js/require-config.js" %}'></script>
    <script>
        requirejs.config({
            //By default load any module IDs from js/lib
            // TODO: enable build in release mode once we start actually doing it
            //baseUrl: ('{{ settings.DEBUG }}' === 'True' ?
                //'{% static "js/cel" %}' : '{% static "js/cel-build" %}')
            baseUrl: '{% static "js/cel" %}'
        });
         
        // Cheat to win, make a global object
        // We need this because:
        //   a) We can only render this in a django template
        //   b) We need access to the GOOGLE_MAPS_KEY to load google maps using require.
        //      If we put it in an AMD module, we have to first load the module, then 
        //      have a nested require statement to load google maps, which is a PITA.
        //      
        // So, if you need to require google maps, do something like
        // define([CEL.serverVars.gmapRequire], function() { ... })
        CEL = {
            serverVars: {
                latSettings: '{{ settings.LATITUDE|stringformat:'f' }}',
                lngSettings: '{{ settings.LONGITUDE|stringformat:'f' }}',
                zoomSettings: '{{ settings.ZOOM_THRESHOLD }}',
                gmapKey: '{{ settings.GOOGLE_MAPS_KEY }}',
                gmapRequire: 'async!http://maps.googleapis.com/maps/api/js?v=3.2&key=' +
                    '{{ settings.GOOGLE_MAPS_KEY }}' + '&sensor=false',
                autocomplete: {
                    swlat: {{ settings.AUTOCOMPLETE.SW_LAT|stringformat:'f' }},
                    swlng: {{ settings.AUTOCOMPLETE.SW_LNG|stringformat:'f' }},
                    nelat: {{ settings.AUTOCOMPLETE.NE_LAT|stringformat:'f' }},
                    nelng: {{ settings.AUTOCOMPLETE.NE_LNG|stringformat:'f' }}
                }
            }
        };
        // This forces loading of minified common libs rather than loading them separately
        require(['common'], function() { });
     </script>
    {% block scripts %}{% endblock %}
  </body> 
</html> 
